(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{76:(e,a,n)=>{"use strict";n.d(a,{T3:()=>l,jS:()=>c});var t=n(5317),o=n(6104);let i={REZERWY:{id:"89039437-62a7-4eda-b67d-70a4fb24e4ea",name:"Rezerwy"},U19:{id:"1595da8a-a9d6-463d-a49d-5e2c41ff36be",name:"U19"},U17:{id:"58f3862c-75d5-4fa7-a18d-0c8e3b00402a",name:"U17"},U16:{id:"06141fa4-80bc-404e-8fcb-63ef2d0a7815",name:"U16"},U15:{id:"0ebf0d57-4f2c-4c12-937f-635feb2af332",name:"U15"}},s=null,r=0;async function c(){let e=Date.now();if(s&&e-r<36e5)return console.log("Używam zapisanych w pamięci danych o zespołach"),s;try{console.log("Pobieranie zespoł\xf3w z Firebase...");let a=(0,t.rJ)(o.db,"teams"),n=await (0,t.GG)(a);if(n.empty)return console.warn("Brak zespoł\xf3w w Firebase, używam domyślnych danych"),i;let c={};return n.forEach(e=>{var a;let n=e.data();c[(null===(a=Object.entries(i).find(e=>{let[a,t]=e;return t.id===n.id}))||void 0===a?void 0:a[0])||n.id]={id:n.id,name:n.name}}),s=c,r=e,console.log("Pobrano zespoły z Firebase:",Object.keys(c).length),c}catch(e){return console.error("Błąd podczas pobierania zespoł\xf3w z Firebase:",e),console.warn("Używam domyślnych danych o zespołach"),i}}let l=i},365:e=>{e.exports={offlineStatus:"OfflineStatus_offlineStatus__ZVFV5",hasError:"OfflineStatus_hasError__i5QHz",icon:"OfflineStatus_icon__zcpiV",offlineIndicator:"OfflineStatus_offlineIndicator__RbenR",errorContainer:"OfflineStatus_errorContainer__geiW5",errorMessage:"OfflineStatus_errorMessage__hssPo",networkButton:"OfflineStatus_networkButton__UZ0Uq",reloadButton:"OfflineStatus_reloadButton__Spqt3",resetButton:"OfflineStatus_resetButton__h4am5"}},2331:e=>{e.exports={exportButton:"ExportButton_exportButton__w_fQs",icon:"ExportButton_icon__qYcai",buttonsContainer:"ExportButton_buttonsContainer__oKfHd"}},5143:e=>{e.exports={tabsContainer:"Tabs_tabsContainer__H_oEU",tabs:"Tabs_tabs__tVXxO",tab:"Tabs_tab__HeYbT",active:"Tabs_active__xSwfW"}},5273:(e,a,n)=>{Promise.resolve().then(n.bind(n,8438))},5645:e=>{e.exports={importButton:"ImportButton_importButton__Vl3ah",icon:"ImportButton_icon__tsd_e"}},7305:e=>{e.exports={playersGrid:"PlayersGrid_playersGrid___n5e_",playerTile:"PlayersGrid_playerTile__aXY3k",selected:"PlayersGrid_selected__J8dDG",withImage:"PlayersGrid_withImage__2w02_",playerTileImage:"PlayersGrid_playerTileImage__LG9Sz",playerTileOverlay:"PlayersGrid_playerTileOverlay__2UPXm",playerContent:"PlayersGrid_playerContent__6Zzwq",number:"PlayersGrid_number__ZsOmT",playerInfo:"PlayersGrid_playerInfo___mXOa",name:"PlayersGrid_name__Jpw7d",details:"PlayersGrid_details__J1GrN",position:"PlayersGrid_position__qAl0z",birthYear:"PlayersGrid_birthYear___pBKa",editBtn:"PlayersGrid_editBtn__Ak0aB",deleteBtn:"PlayersGrid_deleteBtn__potyf",addPlayerTile:"PlayersGrid_addPlayerTile__yITDA"}},8085:e=>{e.exports={instructionsContainer:"Instructions_instructionsContainer__pMI5g",toggleButton:"Instructions_toggleButton__meEul",toggleIcon:"Instructions_toggleIcon__At5I7",instructionsContent:"Instructions_instructionsContent__qE_C5",sectionTabs:"Instructions_sectionTabs__w3zDg",sectionTab:"Instructions_sectionTab__0s1Og",activeTab:"Instructions_activeTab__7aWHC",instructionsList:"Instructions_instructionsList__supoo",instructionFooter:"Instructions_instructionFooter__DVzZd",tip:"Instructions_tip__zdyCs",tipIcon:"Instructions_tipIcon__DN7PT",arrow:"Instructions_arrow__vQs0D",up:"Instructions_up__cawd3",instructionStep:"Instructions_instructionStep__oeaIr",stepNumber:"Instructions_stepNumber__KBaII",stepContent:"Instructions_stepContent__LX6Mm",cardInfo:"Instructions_cardInfo__d_v1k",tipsGrid:"Instructions_tipsGrid__MhavL",tipCard:"Instructions_tipCard__FOUL_",dataSection:"Instructions_dataSection__Xh3sD",iconSmall:"Instructions_iconSmall__XNRl7",dataNote:"Instructions_dataNote__5A4IT"}},8334:e=>{e.exports={container:"page_container__aoG4z",content:"page_content__kDoxQ",buttonsContainer:"page_buttonsContainer__CVJnq",logoutButton:"page_logoutButton__K4PKs"}},8412:(e,a,n)=>{"use strict";n.d(a,{A:()=>p});var t=n(2115),o=n(6104),i=n(5317);let s=e=>new TextEncoder().encode(e),r=e=>btoa(String.fromCharCode(...new Uint8Array(e))),c=e=>{let a=atob(e),n=new Uint8Array(a.length);for(let e=0;e<a.length;e++)n[e]=a.charCodeAt(e);return n.buffer},l=()=>crypto.getRandomValues(new Uint8Array(16)).buffer,d=async e=>{try{let a=l(),n=await crypto.subtle.importKey("raw",s(e),{name:"PBKDF2"},!1,["deriveBits","deriveKey"]),t=await crypto.subtle.deriveKey({name:"PBKDF2",salt:a,iterations:1e5,hash:"SHA-256"},n,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),o=await crypto.subtle.exportKey("raw",t),i=r(o),c=r(a);return{hash:i,salt:c}}catch(e){throw console.error("Błąd podczas haszowania hasła:",e),Error("Nie udało się zahaszować hasła")}},u=async(e,a,n)=>{try{let t=c(n),o=await crypto.subtle.importKey("raw",s(e),{name:"PBKDF2"},!1,["deriveBits","deriveKey"]),i=await crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:1e5,hash:"SHA-256"},o,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),l=await crypto.subtle.exportKey("raw",i);return r(l)===a}catch(e){return console.error("Błąd podczas por\xf3wnywania hasła:",e),!1}},m="packing_app_auth_token";function p(){let[e,a]=(0,t.useState)(!1),[n,s]=(0,t.useState)(!0);(0,t.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem(m);if(!e){a(!1),s(!1);return}let n=(0,i.H9)(o.db,"settings","password");if((await (0,i.x7)(n)).exists()){let n=e.split("_");if(2===n.length){let e=parseInt(n[1],10);if(Date.now()-e<864e5){a(!0),s(!1);return}}}localStorage.removeItem(m),a(!1)}catch(e){console.error("Błąd podczas weryfikacji autentykacji:",e),a(!1)}finally{s(!1)}})()},[]);let r=async e=>{try{s(!0);let{hash:n,salt:t}=await d(e),r=(0,i.H9)(o.db,"settings","password");await (0,i.BN)(r,{hash:n,salt:t,updatedAt:new Date});let c="auth_".concat(Date.now());return localStorage.setItem(m,c),a(!0),!0}catch(e){return console.error("Błąd podczas ustawiania hasła:",e),!1}finally{s(!1)}};return{isAuthenticated:e,isLoading:n,login:async e=>{try{s(!0);let n=(0,i.H9)(o.db,"settings","password"),t=await (0,i.x7)(n);if(!t.exists())return await r(e),!0;let{hash:c,salt:l}=t.data();if(await u(e,c,l)){let e="auth_".concat(Date.now());return localStorage.setItem(m,e),a(!0),!0}return!1}catch(e){return console.error("Błąd podczas logowania:",e),!1}finally{s(!1)}},logout:()=>{localStorage.removeItem(m),a(!1)},setPassword:r}}},8438:(e,a,n)=>{"use strict";let t;n.r(a),n.d(a,{default:()=>Y});var o=n(5155),i=n(2115),s=n(5028),r=n(8085),c=n.n(r);function l(){let[e,a]=(0,i.useState)(!1),[n,t]=(0,i.useState)("basic"),s=(0,i.useMemo)(()=>({basic:{title:"Podstawy analizy",content:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:c().instructionStep,children:[(0,o.jsx)("div",{className:c().stepNumber,children:"1"}),(0,o.jsxs)("div",{className:c().stepContent,children:[(0,o.jsx)("h4",{children:"Przygotowanie meczu"}),(0,o.jsx)("p",{children:"Wybierz drużynę i stw\xf3rz nowy mecz, wprowadzając przeciwnika i inne dane."})]})]}),(0,o.jsxs)("div",{className:c().instructionStep,children:[(0,o.jsx)("div",{className:c().stepNumber,children:"2"}),(0,o.jsxs)("div",{className:c().stepContent,children:[(0,o.jsx)("h4",{children:"Rejestrowanie akcji"}),(0,o.jsxs)("ul",{children:[(0,o.jsxs)("li",{children:["Kliknij na ",(0,o.jsx)("strong",{children:"strefę początkową"})," na boisku (skąd zaczyna się akcja)"]}),(0,o.jsxs)("li",{children:["Następnie kliknij na ",(0,o.jsx)("strong",{children:"strefę końcową"})," na boisku (gdzie kończy się akcja)"]}),(0,o.jsxs)("li",{children:["W otwartym oknie ",(0,o.jsx)("strong",{children:"wybierz zawodnika rozpoczynającego"})," akcję"]}),(0,o.jsxs)("li",{children:["Wybierz ",(0,o.jsx)("strong",{children:"zawodnika kończącego"})," akcję (przy podaniu) lub zaznacz zawodnika dryblującego"]}),(0,o.jsxs)("li",{children:["Ustaw ",(0,o.jsx)("strong",{children:"minutę meczu"})," (0-90+)"]}),(0,o.jsx)("li",{children:"Dodaj punkty packing i opcjonalne dodatkowe parametry akcji"})]})]})]}),(0,o.jsxs)("div",{className:c().instructionStep,children:[(0,o.jsx)("div",{className:c().stepNumber,children:"3"}),(0,o.jsxs)("div",{className:c().stepContent,children:[(0,o.jsx)("h4",{children:"Dodatkowe opcje"}),(0,o.jsxs)("ul",{children:[(0,o.jsxs)("li",{children:[(0,o.jsx)("strong",{children:"P3"})," - podanie za linię obrony"]}),(0,o.jsxs)("li",{children:[(0,o.jsx)("strong",{children:"Strzał"})," - zaznacz, jeśli akcja kończy się strzałem"]}),(0,o.jsxs)("li",{children:[(0,o.jsx)("strong",{children:"Gol"})," - zaznacz, jeśli akcja kończy się golem"]}),(0,o.jsxs)("li",{children:[(0,o.jsx)("strong",{children:"Wejście w pole karne"})," - podanie lub drybling w pole karne"]})]})]})]})]})},scoring:{title:"System punktacji",content:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:c().cardInfo,children:[(0,o.jsx)("h4",{children:"Punkty Packing"}),(0,o.jsx)("p",{children:"Punkty są przyznawane automatycznie w oparciu o:"}),(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:"Liczbę ominętych zawodnik\xf3w"}),(0,o.jsx)("li",{children:"Pozycję na boisku (strefy)"}),(0,o.jsx)("li",{children:"Jakość wykonania podania"})]})]}),(0,o.jsxs)("div",{className:c().cardInfo,children:[(0,o.jsx)("h4",{children:"Expected Threat (xT)"}),(0,o.jsx)("p",{children:"Wartość odzwierciedlająca potencjał bramkowy danej strefy boiska."}),(0,o.jsxs)("ul",{children:[(0,o.jsx)("li",{children:"Wyższe wartości xT bliżej bramki przeciwnika"}),(0,o.jsx)("li",{children:"Służy jako mnożnik wartości punkt\xf3w packing"}),(0,o.jsx)("li",{children:"Pomaga ocenić efektywność akcji w kontekście strategicznym"})]})]}),(0,o.jsxs)("div",{className:c().cardInfo,children:[(0,o.jsx)("h4",{children:"Dodatkowe metryki"}),(0,o.jsxs)("ul",{children:[(0,o.jsxs)("li",{children:[(0,o.jsx)("strong",{children:"Podania P3:"})," Podania za linię obrony (wyższy wsp\xf3łczynnik)"]}),(0,o.jsxs)("li",{children:[(0,o.jsx)("strong",{children:"Wejścia w pole karne:"})," Akcje kończące się w polu karnym"]}),(0,o.jsxs)("li",{children:[(0,o.jsx)("strong",{children:"Strzały i gole:"})," Finalizacja akcji"]})]})]})]})},data:{title:"Zarządzanie danymi",content:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:c().dataSection,children:[(0,o.jsxs)("h4",{children:["Eksport danych ",(0,o.jsx)("span",{className:c().iconSmall,children:"\uD83D\uDCE4"})]}),(0,o.jsx)("p",{children:"Regularnie eksportuj dane meczu, aby zabezpieczyć swoją pracę:"}),(0,o.jsxs)("ol",{children:[(0,o.jsxs)("li",{children:["Kliknij przycisk ",(0,o.jsx)("strong",{children:"Eksportuj dane"})," na dole strony"]}),(0,o.jsx)("li",{children:"Plik JSON zostanie pobrany na twoje urządzenie"}),(0,o.jsx)("li",{children:"Zawiera wszystkie dane meczu, zawodnik\xf3w i akcji"}),(0,o.jsxs)("li",{children:["Plik nazwany jest automatycznie według wzoru: ",(0,o.jsx)("code",{children:"packing_[drużyna]_vs_[przeciwnik]_[data].json"})]})]})]}),(0,o.jsxs)("div",{className:c().dataSection,children:[(0,o.jsxs)("h4",{children:["Import danych ",(0,o.jsx)("span",{className:c().iconSmall,children:"\uD83D\uDCE5"})]}),(0,o.jsx)("p",{children:"Przywracaj dane z wcześniej zapisanych plik\xf3w:"}),(0,o.jsxs)("ol",{children:[(0,o.jsxs)("li",{children:["Kliknij przycisk ",(0,o.jsx)("strong",{children:"Importuj dane"})," na dole strony"]}),(0,o.jsx)("li",{children:"Wybierz plik JSON z eksportowanymi wcześniej danymi"}),(0,o.jsx)("li",{children:"Dane zostaną zaimportowane do aplikacji"}),(0,o.jsx)("li",{children:"Istniejące dane nie zostaną nadpisane, tylko uzupełnione"})]})]}),(0,o.jsx)("div",{className:c().dataNote,children:(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Uwaga:"})," Zalecamy regularne eksportowanie danych po każdym meczu lub nawet w trakcie dłuższych mecz\xf3w, aby zabezpieczyć się przed utratą danych."]})})]})},tips:{title:"Wskaz\xf3wki",content:(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:c().tipsGrid,children:[(0,o.jsxs)("div",{className:c().tipCard,children:[(0,o.jsx)("span",{className:c().tipIcon,children:"\uD83C\uDFAF"}),(0,o.jsx)("h4",{children:"Dokładność analizy"}),(0,o.jsx)("p",{children:"Nie liczymy podań, kt\xf3re nie są w prz\xf3d, i tych, kt\xf3re nie mijają żadnego zawodnika. Liczymy packing i xT na wysokości pola karnego, także w poprzek (w kierunku bramki)."})]}),(0,o.jsxs)("div",{className:c().tipCard,children:[(0,o.jsx)("span",{className:c().tipIcon,children:"⏱️"}),(0,o.jsx)("h4",{children:"Zarządzanie czasem"}),(0,o.jsx)("p",{children:"Po zapisaniu akcji minuta pozostaje niezmieniona, co ułatwia wprowadzanie serii podań z tego samego momentu meczu."})]}),(0,o.jsxs)("div",{className:c().tipCard,children:[(0,o.jsx)("span",{className:c().tipIcon,children:"\uD83D\uDD04"}),(0,o.jsx)("h4",{children:"Regularne kopie zapasowe"}),(0,o.jsx)("p",{children:"Eksportuj dane po każdym meczu lub w jego trakcie. Import pozwala przywr\xf3cić dane w przypadku problem\xf3w."})]}),(0,o.jsxs)("div",{className:c().tipCard,children:[(0,o.jsx)("span",{className:c().tipIcon,children:"\uD83D\uDCCA"}),(0,o.jsx)("h4",{children:"Analiza połączeń"}),(0,o.jsx)("p",{children:"Zwracaj uwagę na połączenia między zawodnikami w sekcji statystyk, aby identyfikować najskuteczniejsze schematy podań."})]})]})})}}),[]);return e?(0,o.jsxs)("div",{className:c().instructionsContainer,children:[(0,o.jsxs)("button",{className:c().toggleButton,onClick:()=>a(!1),"aria-expanded":"true",children:[(0,o.jsx)("span",{className:c().toggleIcon,children:"\uD83D\uDCD6"}),"Ukryj instrukcję",(0,o.jsx)("span",{className:"".concat(c().arrow," ").concat(c().up),children:"▼"})]}),(0,o.jsxs)("div",{className:c().instructionsContent,children:[(0,o.jsx)(()=>(0,o.jsx)("div",{className:c().sectionTabs,children:Object.entries(s).map(e=>{let[a,i]=e;return(0,o.jsx)("button",{className:"".concat(c().sectionTab," ").concat(n===a?c().activeTab:""),onClick:()=>t(a),children:i.title},a)})}),{}),(0,o.jsxs)("div",{className:c().instructionsList,children:[(0,o.jsx)("h3",{children:s[n].title}),s[n].content]}),(0,o.jsx)("div",{className:c().instructionFooter,children:(0,o.jsxs)("div",{className:c().tip,children:[(0,o.jsx)("span",{className:c().tipIcon,children:"\uD83D\uDCA1"}),(0,o.jsx)("p",{children:"Dokładna i konsekwentna analiza podań pozwoli na uzyskanie wartościowych danych o stylu gry drużyny i skuteczności zawodnik\xf3w."})]})})]})]}):(0,o.jsx)("div",{className:c().instructionsContainer,children:(0,o.jsxs)("button",{className:c().toggleButton,onClick:()=>a(!0),"aria-expanded":"false",children:[(0,o.jsx)("span",{className:c().toggleIcon,children:"\uD83D\uDCD6"}),"Pokaż instrukcję",(0,o.jsx)("span",{className:"".concat(c().arrow," ").concat(c().down),children:"▼"})]})})}var d=n(7305),u=n.n(d);let m=(0,i.memo)(function(e){let{player:a,isSelected:n,onSelect:t,onEdit:s,onDelete:r}=e,[c,l]=(0,i.useState)(!1);(0,i.useEffect)(()=>{l(!0)},[]);let d=!!a.imageUrl,m=(0,i.useCallback)(e=>{e.currentTarget.style.display="none"},[]),p=(0,i.useCallback)(e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),t(a.id))},[a.id,t]),y=(0,i.useCallback)(e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),e.stopPropagation(),s(a.id))},[a.id,s]),w=(0,i.useCallback)(e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),e.stopPropagation(),r(a.id))},[a.id,r]),h=(0,i.useCallback)(()=>{c&&t(a.id)},[c,a.id,t]);return c?(0,o.jsxs)("div",{className:"".concat(u().playerTile," ").concat(n?u().selected:""," ").concat(d?u().withImage:""),onClick:h,onKeyDown:p,role:"button",tabIndex:0,"aria-pressed":n,"aria-label":"Wybierz gracza: ".concat(a.name,", numer ").concat(a.number),children:[d&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("img",{src:a.imageUrl,alt:"",className:u().playerTileImage,onError:m}),(0,o.jsx)("div",{className:u().playerTileOverlay})]}),(0,o.jsxs)("div",{className:u().playerContent,children:[(0,o.jsx)("div",{className:u().number,children:a.number}),(0,o.jsx)("button",{className:u().editBtn,onClick:e=>{e.stopPropagation(),s(a.id)},onKeyDown:y,title:"Edytuj","aria-label":"Edytuj gracza: ".concat(a.name),children:"✎"}),(0,o.jsx)("button",{className:u().deleteBtn,onClick:e=>{e.stopPropagation(),r(a.id)},onKeyDown:w,title:"Usuń","aria-label":"Usuń gracza: ".concat(a.name),children:"✕"}),(0,o.jsxs)("div",{className:u().playerInfo,children:[(0,o.jsx)("div",{className:u().name,children:a.name}),(0,o.jsxs)("div",{className:u().details,children:[a.position&&(0,o.jsx)("span",{className:u().position,children:a.position}),a.birthYear&&(0,o.jsx)("span",{className:u().birthYear,children:a.birthYear})]})]})]})]}):(0,o.jsx)("div",{className:"".concat(u().playerTile," ").concat(d?u().withImage:""),"aria-label":"Ładowanie zawodnika...",children:(0,o.jsxs)("div",{className:u().playerContent,children:[(0,o.jsx)("div",{className:u().number,children:a.number}),(0,o.jsx)("div",{className:u().playerInfo,children:(0,o.jsx)("div",{className:u().name,children:a.name})})]})})});m.displayName="PlayerTile";let p=(0,i.memo)(function(e){let{players:a,selectedPlayerId:n,onPlayerSelect:t,onAddPlayer:s,onEditPlayer:r,onDeletePlayer:c}=e,[l,d]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{d(!0)},[]),l)?(0,o.jsxs)("div",{className:u().playersGrid,children:[a.map(e=>(0,o.jsx)(m,{player:e,isSelected:e.id===n,onSelect:t,onEdit:r,onDelete:c},e.id)),(0,o.jsx)("div",{className:"".concat(u().playerTile," ").concat(u().addPlayerTile),onClick:s,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),s())},role:"button",tabIndex:0,"aria-label":"Dodaj nowego zawodnika",children:"+"})]}):(0,o.jsx)("div",{className:u().playersGridPlaceholder,children:"Ładowanie zawodnik\xf3w..."})});p.displayName="PlayersGrid";var y=n(5143),w=n.n(y);function h(e){let{activeTab:a,onTabChange:n}=e;return(0,o.jsx)("div",{className:w().tabsContainer,role:"tablist","aria-orientation":"horizontal",children:(0,o.jsx)("div",{className:w().tabs,children:(0,o.jsx)("button",{className:"".concat(w().tab," ").concat("packing"===a?w().active:""),onClick:e=>{e.preventDefault(),n("packing")},role:"tab","aria-selected":"packing"===a,"aria-controls":"packing-panel",id:"packing-tab",children:"Packing"})})})}var z=n(6104),g=n(5317);let f={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},j=new Uint8Array(16),b=[];for(let e=0;e<256;++e)b.push((e+256).toString(16).slice(1));let k=function(e,a,n){if(f.randomUUID&&!a&&!e)return f.randomUUID();let o=(e=e||{}).random??e.rng?.()??function(){if(!t){if("undefined"==typeof crypto||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");t=crypto.getRandomValues.bind(crypto)}return t(j)}();if(o.length<16)throw Error("Random bytes length must be >= 16");if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,a){if((n=n||0)<0||n+16>a.length)throw RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)a[n+e]=o[e];return a}return function(e,a=0){return(b[e[a+0]]+b[e[a+1]]+b[e[a+2]]+b[e[a+3]]+"-"+b[e[a+4]]+b[e[a+5]]+"-"+b[e[a+6]]+b[e[a+7]]+"-"+b[e[a+8]]+b[e[a+9]]+"-"+b[e[a+10]]+b[e[a+11]]+b[e[a+12]]+b[e[a+13]]+b[e[a+14]]+b[e[a+15]]).toLowerCase()}(o)};var v=n(9046);function I(e){if("string"==typeof e)return e;let a=Math.floor(e/12)+1,n=String.fromCharCode(97+e%12);return"".concat(n).concat(a)}function S(e){let a={};return Object.keys(e).forEach(n=>{let t=e[n];void 0!==t&&(null===t||"object"!=typeof t||Array.isArray(t)?Array.isArray(t)?a[n]=t.map(e=>null!==e&&"object"==typeof e?S(e):e):a[n]=t:a[n]=S(t))}),a}let _="packing_matches_cache",x={isProcessing:!1,queue:[],add:function(e){return new Promise((a,n)=>{this.queue.push({operation:e,resolve:a,reject:n}),this.isProcessing||this.processQueue()})},processQueue:async function(){if(this.isProcessing||0===this.queue.length)return;this.isProcessing=!0,await new Promise(e=>setTimeout(e,100));let{operation:e,resolve:a,reject:n}=this.queue.shift();try{await new Promise(e=>setTimeout(e,200));let n=await e();a(n)}catch(e){console.error("Błąd podczas wykonywania operacji Firebase:",e),n(e)}finally{setTimeout(()=>{this.isProcessing=!1,this.queue.length>0&&this.processQueue()},300)}}};async function D(e){let a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;for(let o=0;o<n;o++)try{return o>0&&await new Promise(e=>setTimeout(e,t*Math.pow(2,o-1))),await e()}catch(e){console.warn("Pr\xf3ba ".concat(o+1,"/").concat(n," nie powiodła się:"),e),a=e}throw a}var E=n(76),N=n(9729),P=n(8334),B=n.n(P),C=n(365),T=n.n(C);let F=e=>{let{className:a}=e,[n,t]=(0,i.useState)(!0),[s,r]=(0,i.useState)(!0),[c,l]=(0,i.useState)(!1),[d,u]=(0,i.useState)(null),[m,p]=(0,i.useState)(!1),[y,w]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let e=setTimeout(()=>{t(navigator.onLine),console.log("Status połączenia:",navigator.onLine?"online":"offline"),navigator.onLine&&h(),p(!0)},3e3),a=()=>{console.log("Aplikacja przeszła w tryb online"),t(!0),m&&f()},n=()=>{console.log("Aplikacja przeszła w tryb offline"),t(!1),m&&j()},o=e=>{e.error&&"string"==typeof e.error.message&&e.error.message.includes("Firestore")&&(e.error.message.includes("INTERNAL ASSERTION FAILED")||e.error.message.includes("invalid-argument"))&&(u("Wykryto problem z połączeniem do bazy danych."),r(!1))};return window.addEventListener("online",a),window.addEventListener("offline",n),window.addEventListener("error",o),()=>{clearTimeout(e),window.removeEventListener("online",a),window.removeEventListener("offline",n),window.removeEventListener("error",o)}},[m]);let h=async()=>{try{l(!0),await (0,g.Os)(z.db),console.log("Połączenie z Firestore działa poprawnie"),u(null),r(!0)}catch(a){console.error("Błąd podczas sprawdzania połączenia z Firestore:",a);let e=a instanceof Error?a.message:"Nieznany błąd";u("Problem z połączeniem do Firebase: ".concat(e)),r(!1)}finally{l(!1)}},f=async()=>{l(!0);try{await (0,g.Os)(z.db),console.log("Sieć Firebase włączona pomyślnie"),r(!0),u(null)}catch(a){console.error("Błąd podczas włączania sieci Firebase:",a);let e=a instanceof Error?a.message:"Nieznany błąd";u("Nie można włączyć synchronizacji: ".concat(e)),r(!1)}finally{l(!1)}},j=async()=>{try{await (0,g.LA)(z.db),console.log("Sieć Firebase wyłączona pomyślnie"),r(!1)}catch(e){console.error("Błąd podczas wyłączania sieci Firebase:",e)}},b=async()=>{n&&!c&&await f()},k=async()=>{w(!0);try{await (0,v.XV)(z.db)?(u(null),r(!0),alert("Pomyślnie zresetowano połączenie z bazą danych. Zalecane jest odświeżenie strony."),window.confirm("Czy chcesz odświeżyć stronę, aby zastosować zmiany?")&&window.location.reload()):alert("Nie udało się zresetować połączenia. Spr\xf3buj odświeżyć stronę.")}catch(e){console.error("Błąd podczas resetowania połączenia:",e),alert("Wystąpił błąd podczas resetowania połączenia.")}finally{w(!1)}};return!m||n&&s&&!d?null:(0,o.jsxs)("div",{className:"".concat(T().offlineStatus," ").concat(a||""," ").concat(d?T().hasError:""),children:[!n&&(0,o.jsxs)("div",{className:T().offlineIndicator,children:[(0,o.jsx)("span",{className:T().icon,children:"⚠️"}),(0,o.jsx)("span",{children:"Brak połączenia z internetem. Tryb offline aktywny."})]}),!s&&n&&(0,o.jsxs)("div",{className:T().pendingRequests,children:[(0,o.jsx)("span",{children:"Tryb offline aktywny. Dane nie są synchronizowane z Firebase."}),(0,o.jsx)("button",{className:T().syncButton,onClick:b,disabled:c,children:c?"Synchronizacja...":"Włącz synchronizację"})]}),d&&(0,o.jsxs)("div",{className:T().errorContainer,children:[(0,o.jsxs)("p",{className:T().errorMessage,children:[(0,o.jsx)("span",{className:T().icon,children:"⚠️"}),d]}),(0,o.jsx)("button",{className:T().resetButton,onClick:k,disabled:y,children:y?"Resetowanie...":"Resetuj połączenie"})]})]})};var A=n(2331),Z=n.n(A);let M=e=>{let{players:a,actions:n,matchInfo:t}=e;return(0,o.jsxs)("button",{className:Z().exportButton,onClick:()=>{let e=t||{matchId:crypto.randomUUID(),note:"Brak szczeg\xf3łowych informacji o meczu"},o="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify({exportDate:new Date().toISOString(),formatVersion:"2.0",exportType:"match_data",appInfo:{name:"Packing Analyzer",version:"1.0.0"},matchInfo:e,players:a,actions:n},null,2)),i=t?"packing_".concat(t.team,"_vs_").concat(t.opponent,"_").concat(t.date.replace(/\//g,"-"),".json"):"packing_data.json",s=document.createElement("a");s.setAttribute("href",o),s.setAttribute("download",i),s.click()},title:"Eksportuj dane do pliku JSON",children:[(0,o.jsx)("span",{className:Z().icon,children:"\uD83D\uDCE4"}),"Eksportuj dane"]})};var R=n(5645),O=n.n(R);let U=e=>{let{onImportSuccess:a,onImportError:n}=e,[t,s]=(0,i.useState)(!1),r=(0,i.useRef)(null),c=async e=>{var t;let o=null===(t=e.target.files)||void 0===t?void 0:t[0];if(o){s(!0);try{let e=await l(o),n=JSON.parse(e);if(!n.matchInfo||!n.players||!n.actions)throw Error("Nieprawidłowy format pliku. Brak wymaganych danych.");await d(n),a({players:n.players,actions:n.actions,matchInfo:n.matchInfo})}catch(e){console.error("Błąd importu:",e),n("Błąd importu: ".concat(e instanceof Error?e.message:String(e)))}finally{s(!1),r.current&&(r.current.value="")}}},l=e=>new Promise((a,n)=>{let t=new FileReader;t.onload=e=>{var t;(null===(t=e.target)||void 0===t?void 0:t.result)?a(e.target.result):n(Error("Nie udało się odczytać pliku"))},t.onerror=()=>n(Error("Błąd podczas odczytu pliku")),t.readAsText(e)}),d=async e=>{let a=e.matchInfo;a.matchId||(a.matchId=crypto.randomUUID()),a.time||(a.time=""),await Promise.all([u(e.players,a),m(e.actions,a)])},u=async(e,a)=>{let n=new Map;for(let a of e){let e=(0,g.P)((0,g.rJ)(z.db,"players"),(0,g._M)("id","==",a.id)),t=await (0,g.GG)(e);if(!t.empty){let e={id:t.docs[0].id,...t.docs[0].data()};n.set(a.id,e)}}let t=(0,g.wP)(z.db);for(let o of e)if(!n.has(o.id)){let e=(0,g.H9)((0,g.rJ)(z.db,"players"));t.set(e,{...o,teams:[a.team]})}await t.commit(),console.log("Gracze zaimportowani do Firebase")},m=async(e,a)=>{let n=(0,g.P)((0,g.rJ)(z.db,"actions_packing"),(0,g._M)("matchId","==",a.matchId)),t=new Set((await (0,g.GG)(n)).docs.map(e=>e.data().id)),o=e.filter(e=>!t.has(e.id)),i=(0,g.wP)(z.db);for(let e of o){let n=(0,g.H9)((0,g.rJ)(z.db,"actions_packing"));i.set(n,{...e,matchId:a.matchId})}return await i.commit(),console.log("Zaimportowano ".concat(o.length," nowych akcji do Firebase")),o.length};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("button",{className:O().importButton,onClick:()=>{r.current&&r.current.click()},disabled:t,title:"Importuj dane z pliku JSON",children:[(0,o.jsx)("span",{className:O().icon,children:t?"⏳":"\uD83D\uDCE5"}),t?"Importowanie...":"Importuj dane"]}),(0,o.jsx)("input",{ref:r,type:"file",accept:".json",onChange:c,style:{display:"none"}})]})};var G=n(9289),H=n(8412);let W=(0,s.default)(()=>Promise.all([n.e(763),n.e(463)]).then(n.bind(n,5463)),{loadableGenerated:{webpack:()=>[5463]},ssr:!1}),L=(0,s.default)(()=>Promise.all([n.e(738),n.e(849)]).then(n.bind(n,8849)),{loadableGenerated:{webpack:()=>[8849]},ssr:!1}),K=(0,s.default)(()=>Promise.all([n.e(254),n.e(597)]).then(n.bind(n,1597)),{loadableGenerated:{webpack:()=>[1597]},ssr:!1}),J=(0,s.default)(()=>Promise.all([n.e(356),n.e(891)]).then(n.bind(n,891)),{loadableGenerated:{webpack:()=>[891]},ssr:!1}),V=(0,s.default)(()=>Promise.all([n.e(356),n.e(661)]).then(n.bind(n,661)),{loadableGenerated:{webpack:()=>[661]}}),q=(0,s.default)(()=>Promise.all([n.e(434),n.e(761)]).then(n.bind(n,4761)),{loadableGenerated:{webpack:()=>[4761]},ssr:!1});function Y(){let[e,a]=i.useState("packing"),[n,t]=i.useState(E.T3.REZERWY.id),[s,r]=i.useState(!1),[c,d]=i.useState(null),[u,m]=i.useState(!1),[y,w]=i.useState(null),[f,j]=i.useState(null),[b,P]=i.useState(!1),[C,T]=i.useState(!1),[A,Z]=(0,i.useState)(0),[R,O]=i.useState(null),Y=(0,i.useRef)(null),{players:X,isModalOpen:Q,editingPlayerId:$,setIsModalOpen:ee,handleDeletePlayer:ea,handleSavePlayer:en,handleEditPlayer:et,closeModal:eo}=function(){let[e,a]=(0,i.useState)([]),[n,t]=(0,i.useState)(!1),[o,s]=(0,i.useState)(null),[r,c]=(0,i.useState)(!0);(0,i.useEffect)(()=>{(async()=>{try{c(!0);let e=(0,g.rJ)(z.db,"players"),n=await (0,g.GG)(e);if(n.empty){console.log("Brak zawodnik\xf3w w Firebase - sprawdzam localStorage");try{let e=localStorage.getItem("players");if(e){let n=JSON.parse(e);a(n),console.log("Zapisuję zawodnik\xf3w z localStorage do Firebase...");let t=(0,g.wP)(z.db);n.forEach(e=>{let a=(0,g.H9)((0,g.rJ)(z.db,"players"));t.set(a,{name:e.name,number:e.number,position:e.position||"",birthYear:e.birthYear,imageUrl:e.imageUrl,teams:e.teams||[]})}),await t.commit(),console.log("Zawodnicy z localStorage zapisani do Firebase")}}catch(e){console.error("Błąd odczytu z localStorage:",e)}}else{let e=n.docs.map(e=>({id:e.id,...e.data()}));console.log("Zawodnicy pobrani z Firebase:",e),a(e)}}catch(e){console.error("Błąd pobierania zawodnik\xf3w z Firebase:",e)}finally{c(!1)}})()},[]),(0,i.useEffect)(()=>{if(e.length>0)try{localStorage.setItem("players",JSON.stringify(e))}catch(e){console.error("Błąd zapisu do localStorage:",e)}},[e]);let l=(0,i.useCallback)(async e=>{if(window.confirm("Czy na pewno chcesz usunąć tego zawodnika?"))try{return c(!0),await (0,g.kd)((0,g.H9)(z.db,"players",e)),a(a=>a.filter(a=>a.id!==e)),console.log("Zawodnik usunięty z Firebase"),!0}catch(e){console.error("Błąd usuwania zawodnika:",e),alert("Wystąpił błąd podczas usuwania zawodnika. Spr\xf3buj ponownie.")}finally{c(!1)}return!1},[]),d=(0,i.useCallback)(async e=>{try{if(c(!0),o){let n=(0,g.H9)(z.db,"players",o);await (0,g.mZ)(n,e),a(a=>a.map(a=>a.id===o?{...a,...e,id:o}:a)),console.log("Zawodnik zaktualizowany w Firebase")}else{let n={id:(await (0,g.gS)((0,g.rJ)(z.db,"players"),e)).id,...e};a(e=>[...e,n]),console.log("Nowy zawodnik dodany do Firebase")}t(!1),s(null)}catch(e){console.error("Błąd zapisywania zawodnika:",e),alert("Wystąpił błąd podczas zapisywania zawodnika. Spr\xf3buj ponownie.")}finally{c(!1)}},[o]),u=(0,i.useCallback)(e=>{s(e),t(!0)},[]),m=(0,i.useCallback)(()=>{t(!1),s(null)},[]),p=(0,i.useCallback)(()=>o&&e.find(e=>e.id===o)||null,[e,o]);return{players:e,isModalOpen:n,editingPlayerId:o,editingPlayer:p(),isLoading:r,setIsModalOpen:t,handleDeletePlayer:l,handleSavePlayer:d,handleEditPlayer:u,closeModal:m}}(),{matchInfo:ei,allMatches:es,isMatchModalOpen:er,toggleMatchModal:ec,handleSaveMatchInfo:el,handleSelectMatch:ed,handleDeleteMatch:eu,handleSavePlayerMinutes:em,fetchMatches:ep,isOfflineMode:ey}=function(){let[e,a]=(0,i.useState)(null),[n,t]=(0,i.useState)([]),[o,s]=(0,i.useState)(!1),[r,c]=(0,i.useState)(!1),[l,d]=(0,i.useState)(null),[u,m]=(0,i.useState)(!1),[p,y]=(0,i.useState)(!1),w=(0,i.useRef)({data:[],timestamp:0});(0,i.useEffect)(()=>{let e=()=>{console.log("\uD83C\uDF10 Aplikacja jest online"),y(!1)},a=()=>{console.log("\uD83D\uDCF4 Aplikacja jest offline"),y(!0)};return"undefined"!=typeof navigator&&y(!navigator.onLine),window.addEventListener("online",e),window.addEventListener("offline",a),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",a)}},[]);let h=()=>{try{localStorage.setItem(_,JSON.stringify(w.current)),console.log("\uD83D\uDCBE Cache zapisany do localStorage, element\xf3w:",w.current.data.length)}catch(e){console.error("❌ Błąd podczas zapisywania cache do localStorage:",e)}},f=()=>{try{let e=localStorage.getItem(_);if(e){let a=JSON.parse(e);return console.log("\uD83D\uDCC2 Wczytano cache z localStorage, element\xf3w:",a.data.length),a}}catch(e){console.error("❌ Błąd podczas wczytywania cache z localStorage:",e)}return null},j=(e,a)=>{w.current={data:e,timestamp:Date.now(),lastTeamId:a||w.current.lastTeamId},h()};(0,i.useEffect)(()=>{let e=f();if(e){if(w.current=e,t(e.data),e.data.length>0){let n=e.lastTeamId;if(n){let t=e.data.filter(e=>e.team===n);t.length>0?a(t[0]):a(e.data[0])}else a(e.data[0])}let n=Date.now()-e.timestamp>3e5;!p&&n&&(console.log("\uD83D\uDD52 Cache jest przestarzały, pr\xf3ba odświeżenia danych z Firebase"),b(e.lastTeamId).catch(e=>{console.warn("Nie udało się odświeżyć danych z Firebase:",e)}))}else p||b().catch(e=>{console.warn("Nie udało się pobrać danych z Firebase:",e)})},[p]);let b=async e=>{try{if(m(!0),p){console.log("\uD83D\uDCF4 W trybie offline, używamy tylko lokalnego cache");let a=w.current.data,n=e?a.filter(a=>a.team===e):a;return console.log("\uD83D\uDE91 Używam cache w trybie offline, element\xf3w:",n.length),n}await new Promise(e=>setTimeout(e,300)),console.log("\uD83D\uDD04 Pr\xf3ba synchronizacji danych z Firebase dla zespołu:",e||"wszystkie");let a=await x.add(async()=>D(async()=>{try{let a;let n=(0,g.rJ)(z.db,"matches");a=e?(0,g.P)(n,(0,g._M)("team","==",e),(0,g.My)("date","desc")):(0,g.P)(n,(0,g.My)("date","desc"));let t=await (0,g.GG)(a);if(!t.empty)return t.docs.map(e=>({matchId:e.id,...e.data()}));return console.log("❌ Brak mecz\xf3w w Firebase"),[]}catch(a){if(console.error("⚠️ Błąd przy pobieraniu mecz\xf3w z Firebase:",a),String(a).includes("permission")||String(a).includes("Missing or insufficient permissions")){console.warn("\uD83D\uDD12 Problem z uprawnieniami Firebase, przełączam na tryb offline"),y(!0),d("Brak uprawnień do synchronizacji danych z bazą. Działamy w trybie offline.");let a=w.current.data,n=e?a.filter(a=>a.team===e):a;return console.log("\uD83D\uDE91 Używam cache z powodu problem\xf3w z uprawnieniami, element\xf3w:",n.length),n}throw a}},2,2e3));return console.log("\uD83C\uDFC6 Pobrane mecze z Firebase:",a.length,"element\xf3w"),j(a,e),t(a),a}catch(t){console.error("❌ Błąd podczas pobierania mecz\xf3w z Firebase:",t);let a=w.current.data,n=e?a.filter(a=>a.team===e):a;return console.log("\uD83D\uDE91 Używam cache jako źr\xf3dła awaryjnego, element\xf3w:",n.length),n}finally{m(!1),await new Promise(e=>setTimeout(e,300))}},k=(0,i.useCallback)(async n=>{try{c(!0),d(null),console.log("\uD83D\uDD0D fetchMatches: Rozpoczynam pobieranie mecz\xf3w dla zespołu:",n||"wszystkie");let o=w.current.data;console.log("\uD83D\uDCC2 Cache zawiera ".concat(o.length," mecz\xf3w"));let i=o;if(n&&(i=o.filter(e=>e.team===n),console.log("\uD83D\uDD0D Po filtrowaniu cache'u: ".concat(i.length," mecz\xf3w dla zespołu ").concat(n))),t(i),null==e?void 0:e.matchId){let n=i.find(a=>a.matchId===e.matchId);n?a(n):i.length>0?a(i[0]):a(null)}else i.length>0?a(i[0]):a(null);return p||b(n).then(o=>{if(n){let s=o.filter(e=>e.team===n);if(console.log("\uD83D\uDD04 Odświeżono dane z Firebase: ".concat(s.length," mecz\xf3w dla zespołu ").concat(n)),s.length!==i.length){if(console.log("\uD83D\uDCCA Wykryto r\xf3żnicę między cache a Firebase, aktualizuję stan"),t(s),null==e?void 0:e.matchId){let n=s.find(a=>a.matchId===e.matchId);n?a(n):s.length>0?a(s[0]):a(null)}else s.length>0?a(s[0]):a(null)}}}).catch(e=>{console.warn("Błąd synchronizacji w tle:",e),e&&"string"==typeof e.message&&e.message.includes("INTERNAL ASSERTION FAILED")&&(console.warn("\uD83D\uDEA8 Wykryto błąd wewnętrznego stanu Firestore podczas synchronizacji w tle"),(0,v.IS)(e,z.db).catch(e=>{console.error("Problem podczas obsługi błędu Firestore:",e)}),d("Wystąpił problem z połączeniem do bazy danych. Odśwież stronę, aby rozwiązać problem."))}),i}catch(o){console.error("Błąd podczas pobierania mecz\xf3w:",o),await (0,v.IS)(o,z.db);let e=w.current.data,a=n?e.filter(e=>e.team===n):e;return console.log("\uD83D\uDE91 Używam danych z cache po błędzie:",a.length,"mecz\xf3w"),t(a),d("Wystąpił problem przy pobieraniu danych: ".concat(o instanceof Error?o.message:String(o))),a}finally{c(!1)}},[e,p]),I=async n=>{try{if(console.log("\uD83D\uDD04 Wymuszam pełne odświeżenie danych z Firebase"),c(!0),n){console.log("\uD83D\uDDD1️ Czyszczę cache dla zespołu: ".concat(n));let e=w.current.data.filter(e=>e.team!==n);j(e)}else console.log("\uD83D\uDDD1️ Czyszczę cały cache"),j([]);let o=await b(n);console.log("✅ Pobrano świeże dane z Firebase: ".concat(o.length," element\xf3w"));let i=n?o.filter(e=>e.team===n):o;if(t(i),null==e?void 0:e.matchId){let n=i.find(a=>a.matchId===e.matchId);n?a(n):i.length>0&&a(i[0])}else i.length>0&&a(i[0]);return i}catch(e){return console.error("❌ Błąd podczas wymuszania odświeżenia:",e),d("Błąd podczas odświeżania danych: ".concat(e instanceof Error?e.message:String(e))),[]}finally{c(!1)}},S=(0,i.useCallback)(async e=>{try{let n;c(!0),d(null),console.log("\uD83D\uDCBE handleSaveMatchInfo - rozpoczęcie zapisu meczu"),console.log("\uD83D\uDCCB handleSaveMatchInfo - przekazane info:",e);let o={team:e.team,opponent:e.opponent,isHome:e.isHome,competition:e.competition,date:e.date,playerMinutes:e.playerMinutes||[]};console.log("\uD83E\uDDFE handleSaveMatchInfo - dane meczu do zapisania:",o);let i=e.matchId?e.matchId:Date.now().toString(36)+Math.random().toString(36).substring(2);if(e.matchId){n={matchId:e.matchId,...o};let a=w.current.data.map(a=>a.matchId===e.matchId?n:a);j(a,e.team),t(a=>a.map(a=>a.matchId===e.matchId?n:a))}else{n={matchId:i,...o};let a=[...w.current.data,n];j(a,e.team),t(e=>[...e,n])}return a(n),p?setTimeout(()=>{if("undefined"!=typeof document){let a=new CustomEvent("matchesListRefresh",{detail:{teamId:e.team,timestamp:Date.now()}});document.dispatchEvent(a)}},800):setTimeout(async()=>{try{e.matchId?(console.log("✏️ Pr\xf3ba aktualizacji meczu w Firebase:",e.matchId),await x.add(async()=>D(async()=>{try{let a=(0,g.H9)(z.db,"matches",e.matchId);return await (0,g.mZ)(a,o),!0}catch(e){throw(String(e).includes("permission")||String(e).includes("Missing or insufficient permissions"))&&(console.warn("⚠️ Przełączam na tryb offline z powodu błęd\xf3w uprawnień"),y(!0)),console.error("⚠️ Błąd przy aktualizacji meczu:",e),e}},2)).then(()=>{console.log("✅ Mecz zaktualizowany w Firebase:",e.matchId),setTimeout(async()=>{console.log("♻️ Odświeżam dane po edycji meczu"),await I(e.team)},500)}).catch(e=>{console.error("❌ Nie udało się zaktualizować meczu w Firebase:",e)})):(console.log("➕ Pr\xf3ba dodania meczu do Firebase"),x.add(async()=>D(async()=>{try{return(await (0,g.gS)((0,g.rJ)(z.db,"matches"),o)).id}catch(e){throw(String(e).includes("permission")||String(e).includes("Missing or insufficient permissions"))&&(console.warn("⚠️ Przełączam na tryb offline z powodu błęd\xf3w uprawnień"),y(!0)),console.error("⚠️ Błąd przy dodawaniu meczu:",e),e}},2)).then(o=>{console.log("✅ Nowy mecz dodany do Firebase, ID:",o),n.matchId=o;let s=w.current.data.map(e=>e.matchId===i?n:e);j(s,e.team),t(e=>e.map(e=>e.matchId===i?n:e)),a(n),setTimeout(async()=>{console.log("♻️ Odświeżam dane po dodaniu nowego meczu"),await I(e.team)},500)}).catch(e=>{console.error("❌ Nie udało się dodać meczu do Firebase:",e)})),setTimeout(()=>{if("undefined"!=typeof document){let a="".concat(e.team,"_").concat(Date.now());window._lastRefreshEventId&&window._lastRefreshEventId===a||(window._lastRefreshEventId=a,setTimeout(()=>{if(window._lastRefreshEventId===a){let a=new CustomEvent("matchesListRefresh",{detail:{teamId:e.team,timestamp:Date.now()}});window._lastRefreshEventId="",document.dispatchEvent(a)}},300))}},800)}catch(e){console.error("❌ Błąd podczas synchronizacji z Firebase:",e)}},1500),console.log("✅ handleSaveMatchInfo - zakończenie zapisu meczu, zwracam:",n),n}catch(e){return console.error("Błąd podczas zapisywania informacji o meczu:",e),await (0,v.IS)(e,z.db),null}finally{c(!1)}},[k]),E=(0,i.useCallback)(async(n,o)=>{try{if(c(!0),d(null),!n.matchId)throw Error("Brak ID meczu");let i={...n,playerMinutes:o},s=w.current.data.map(e=>e.matchId===n.matchId?i:e);j(s,n.team),t(e=>e.map(e=>e.matchId===n.matchId?i:e)),(null==e?void 0:e.matchId)===n.matchId&&a(i),p||setTimeout(async()=>{try{let e=(0,g.H9)(z.db,"matches",n.matchId);await (0,g.mZ)(e,{playerMinutes:o}),console.log("✅ Minuty zawodnik\xf3w zaktualizowane w Firebase"),setTimeout(async()=>{console.log("♻️ Odświeżam dane po zmianie minut zawodnik\xf3w"),await I(n.team)},500)}catch(e){console.error("❌ Błąd podczas synchronizacji minut zawodnik\xf3w z Firebase:",e),(String(e).includes("permission")||String(e).includes("Missing or insufficient permissions"))&&(console.warn("⚠️ Przełączam na tryb offline z powodu błęd\xf3w uprawnień"),y(!0))}},500)}catch(e){return console.error("Błąd podczas zapisywania minut zawodnik\xf3w:",e),await (0,v.IS)(e,z.db),!1}finally{c(!1)}},[k]),N=(0,i.useCallback)(async n=>{try{c(!0),d(null),console.log("\uD83D\uDDD1️ Rozpoczynam usuwanie meczu:",n),await new Promise(e=>setTimeout(e,300));let o=w.current.data.find(e=>e.matchId===n);if(!o)return console.error("❌ Nie znaleziono meczu do usunięcia w cache:",n),!1;let i=o.team;console.log("\uD83C\uDFC6 Usuwany mecz należy do zespołu: ".concat(i||"nieznany"));let s=w.current.data.filter(e=>e.matchId!==n);return j(s,i),t(t=>{let o=t.filter(e=>e.matchId!==n);if(console.log("\uD83D\uDCCA Po usunięciu pozostało ".concat(o.length," mecz\xf3w")),(null==e?void 0:e.matchId)===n){if(o.length>0){console.log("\uD83D\uDD04 Wybrany mecz został usunięty, wybieramy nowy z ".concat(o.length," dostępnych"));let e=o.filter(e=>e.team===i);e.length>0?a(e[0]):a(o[0])}else console.log("❗ Brak mecz\xf3w po usunięciu, resetujemy wybrany mecz"),a(null)}return o}),p||setTimeout(async()=>{try{await x.add(async()=>D(async()=>{try{return await (0,g.kd)((0,g.H9)(z.db,"matches",n)),!0}catch(e){throw(String(e).includes("permission")||String(e).includes("Missing or insufficient permissions"))&&(console.warn("⚠️ Przełączam na tryb offline z powodu błęd\xf3w uprawnień"),y(!0)),console.error("⚠️ Błąd przy usuwaniu meczu z Firebase:",e),e}},2)),console.log("✅ Usunięto mecz ".concat(n," z Firebase")),setTimeout(async()=>{console.log("♻️ Odświeżam dane po usunięciu meczu"),await I(i)},500)}catch(e){console.error("❌ Błąd podczas synchronizacji usunięcia meczu z Firebase:",e)}},1e3),setTimeout(()=>{if("undefined"!=typeof document){let e="".concat(i,"_").concat(Date.now());window._lastRefreshEventId&&window._lastRefreshEventId===e||(window._lastRefreshEventId=e,setTimeout(()=>{if(window._lastRefreshEventId===e){let e=new CustomEvent("matchesListRefresh",{detail:{teamId:i,timestamp:Date.now()}});window._lastRefreshEventId="",document.dispatchEvent(e)}},400))}},1e3),!0}catch(e){return console.error("Błąd podczas usuwania meczu:",e),await (0,v.IS)(e,z.db),!1}finally{c(!1)}},[k]);return{matchInfo:e,allMatches:n,isMatchModalOpen:o,isLoading:r,isSyncing:u,error:l,isOfflineMode:p,toggleMatchModal:function(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("toggleMatchModal wywoływany z isOpen=".concat(e,", isNewMatch=").concat(n)),!1===e?(console.log("Zamykanie modalu meczu - ustawiam stan na FALSE"),s(!1)):(console.log("Otwieranie modalu meczu - ustawiam stan na TRUE"),s(!0)),e&&n&&(console.log("Resetowanie danych meczu dla nowego meczu"),setTimeout(()=>{a(null)},0))},handleSaveMatchInfo:S,handleSelectMatch:e=>{a(e)},handleDeleteMatch:N,handleSavePlayerMinutes:E,fetchMatches:k,forceRefreshFromFirebase:I}}(),ew=function(e,a){let[n,t]=(0,i.useState)(null),[o,s]=(0,i.useState)(null),[r,c]=(0,i.useState)(null),[l,d]=(0,i.useState)(1),[u,m]=(0,i.useState)("pass"),[p,y]=(0,i.useState)(0),[w,h]=(0,i.useState)(!1),[f,j]=(0,i.useState)(!1),[b,_]=(0,i.useState)(!1),[x,D]=(0,i.useState)(!1),[E,N]=(0,i.useState)(!1),[P,B]=(0,i.useState)([]),[C,T]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if(null==a?void 0:a.matchId){F(a.matchId);let e=localStorage.getItem("currentHalf");e&&(console.log("usePackingActions: Wczytano połowę z localStorage: ".concat(e)),N("P2"===e))}else B([])},[null==a?void 0:a.matchId]);let F=async e=>{try{T(!0),console.log("Ładowanie akcji dla meczu:",e);let a=(0,g.H9)(z.db,"matches",e),n=await (0,g.x7)(a);if(n.exists()){let a=n.data().actions_packing||[];console.log("Załadowano ".concat(a.length," akcji dla meczu:"),e),console.log("Przykładowe wartości isSecondHalf:",a.slice(0,3).map(e=>e.isSecondHalf));let t=a.map(e=>{let a=S(e);return{...a,isSecondHalf:!0===a.isSecondHalf}});B(t)}else console.log("Nie znaleziono meczu o ID:",e),B([])}catch(e){console.error("Błąd podczas ładowania akcji:",e)}finally{T(!1)}},A=(0,i.useCallback)((e,a,n,t)=>(console.log("Wybrano strefę:",e,a,n,t),c(e),!0),[]),Z=(0,i.useCallback)(async(e,a,t,i,s,r,c)=>{if(console.log("handleSaveAction wywołane z parametrami:",{matchInfoArg:e?{matchId:e.matchId,team:e.team}:null,startZone:a,endZone:t,startZoneXT:i,endZoneXT:s,packingValue:r,isSecondHalfParam:c,startZoneType:typeof a,endZoneType:typeof t,selectedPlayerId:n}),!e)return console.error("Brak danych meczu (matchInfoArg jest null/undefined)"),!1;if(!e.matchId)return console.error("Brak ID meczu w obiekcie matchInfoArg"),!1;if(!(0===a||a))return console.error("Brak strefy początkowej (startZone jest null/undefined)"),!1;if(!(0===t||t))return console.error("Brak strefy końcowej (endZone jest null/undefined)"),!1;if(!n)return console.error("Brak ID zawodnika (selectedPlayerId jest null/undefined)"),!1;try{console.log("Zapisuję akcję do lokalnego stanu i dokumentu meczu..."),console.log("Wartości xT otrzymane:",{startZoneXT:i,endZoneXT:s}),console.log("Informacja o połowie meczu:",c);let d=null!==a?"number"==typeof a?I(a):a:"",m=null!==t?"number"==typeof t?I(t):t:"",y="number"==typeof i?i:void 0,h="number"==typeof s?s:void 0;console.log("Wartości xT do zapisania - Start:",y,"End:",h);let j={id:k(),matchId:e.matchId,teamId:e.team,senderId:n,receiverId:"pass"===u&&o||void 0,fromZone:d,toZone:m,actionType:u,minute:l,packingPoints:r||p,...void 0!==y&&{xTValueStart:y},...void 0!==h&&{xTValueEnd:h},isP3:w,isShot:f,isGoal:b,isPenaltyAreaEntry:x,isSecondHalf:void 0!==c?c:E};console.log("Utworzona akcja z wartościami xT i połową meczu:",{xTValueStart:j.xTValueStart,xTValueEnd:j.xTValueEnd,isSecondHalf:j.isSecondHalf});let _=S(j);console.log("Akcja po oczyszczeniu z wartości undefined:",_),B(e=>[...e,j]);try{console.log("Pr\xf3ba zapisania akcji do dokumentu meczu...");let a=(0,g.H9)(z.db,"matches",e.matchId),n=await (0,g.x7)(a);if(n.exists()){let t=(n.data().actions_packing||[]).map(e=>S(e));await (0,g.mZ)(a,{actions_packing:[...t,_]}),console.log("✅ Akcja została zapisana w dokumencie meczu z ID:",_.id),F(e.matchId)}else console.error("Nie znaleziono meczu o ID:",e.matchId)}catch(e){console.error("❌ Błąd podczas zapisywania akcji w Firebase:",e),await (0,v.IS)(e,z.db)?console.log("✅ Błąd Firestore został obsłużony - akcja została zapisana lokalnie"):console.warn("⚠️ Akcja została dodana tylko lokalnie - synchronizacja z Firebase nieudana")}return console.log("Akcja została zapisana:",j),U(),!0}catch(e){return console.error("Błąd podczas zapisywania akcji:",e),await (0,v.IS)(e,z.db),!1}},[n,o,u,l,p,w,f,b,x,E]),M=(0,i.useCallback)(async e=>{if(!(null==a?void 0:a.matchId))return console.error("Brak ID meczu, nie można usunąć akcji"),!1;console.log("Usuwam akcję:",e);try{B(a=>a.filter(a=>a.id!==e));let n=(0,g.H9)(z.db,"matches",a.matchId),t=await (0,g.x7)(n);if(t.exists()){let a=(t.data().actions_packing||[]).filter(a=>a.id!==e).map(e=>S(e));await (0,g.mZ)(n,{actions_packing:a}),console.log("✅ Akcja została usunięta z dokumentu meczu:",e)}else console.error("Nie znaleziono meczu o ID:",a.matchId);return!0}catch(e){return console.error("Błąd podczas usuwania akcji:",e),await (0,v.IS)(e,z.db),!1}},[null==a?void 0:a.matchId]),R=(0,i.useCallback)(async()=>{if(!(null==a?void 0:a.matchId))return console.error("Brak ID meczu, nie można usunąć akcji"),!1;if(window.confirm("Czy na pewno chcesz usunąć wszystkie akcje?")){console.log("Usuwam wszystkie akcje");try{let e=(0,g.H9)(z.db,"matches",a.matchId);return await (0,g.mZ)(e,{actions_packing:[]}),console.log("✅ Usunięto wszystkie akcje z dokumentu meczu: ".concat(a.matchId)),B([]),!0}catch(e){console.error("Błąd podczas usuwania wszystkich akcji:",e),await (0,v.IS)(e,z.db)}}return!1},[null==a?void 0:a.matchId]),O=(0,i.useCallback)(e=>{console.log("usePackingActions: Zmiana połowy na ".concat(e?"P2":"P1")),N(e),localStorage.setItem("currentHalf",e?"P2":"P1")},[]),U=(0,i.useCallback)(()=>{c(null),y(0),h(!1),j(!1),_(!1),D(!1)},[]);return{actions:P,selectedPlayerId:n,selectedReceiverId:o,selectedZone:r,currentPoints:p,actionMinute:l,actionType:u,isP3Active:w,isShot:f,isGoal:b,isPenaltyAreaEntry:x,isSecondHalf:E,isLoading:C,setSelectedPlayerId:t,setSelectedReceiverId:s,setCurrentPoints:y,setActionMinute:d,setActionType:m,setIsP3Active:h,setIsShot:j,setIsGoal:_,setIsPenaltyAreaEntry:D,setIsSecondHalf:O,handleZoneSelect:A,handleSaveAction:Z,handleDeleteAction:M,handleDeleteAllActions:R,resetActionState:U,loadActionsForMatch:F}}(0,ei),{actions:eh,selectedPlayerId:ez,selectedReceiverId:eg,selectedZone:ef,currentPoints:ej,actionMinute:eb,actionType:ek,isP3Active:ev,isShot:eI,isGoal:eS,isPenaltyAreaEntry:e_,setSelectedPlayerId:ex,setSelectedReceiverId:eD,setCurrentPoints:eE,setActionMinute:eN,setActionType:eP,setIsP3Active:eB,setIsShot:eC,setIsGoal:eT,setIsPenaltyAreaEntry:eF,handleZoneSelect:eA,handleSaveAction:eZ,handleDeleteAction:eM,handleDeleteAllActions:eR,resetActionState:eO}=ew,{logout:eU}=(0,H.A)();(0,i.useEffect)(()=>{O(ef)},[ef]);let eG=(0,i.useMemo)(()=>X.filter(e=>e.teams&&e.teams.includes(n)),[X,n]);i.useEffect(()=>{let e=localStorage.getItem("currentHalf");e&&(console.log("page.tsx: Wczytano wartość połowy z localStorage: ".concat(e)),T("P2"===e))},[]),(0,i.useCallback)(async e=>{console.log("⚡ Wymuszam odświeżenie listy mecz\xf3w dla zespołu:",e||n);try{if(window._isRefreshingMatches){console.log("\uD83D\uDEAB Odświeżanie listy mecz\xf3w już trwa, pomijam");return}window._isRefreshingMatches=!0;let a=await ep(e||n);console.log("\uD83D\uDCCB Lista mecz\xf3w pobrana pomyślnie, element\xf3w:",(null==a?void 0:a.length)||0),a&&setTimeout(()=>{Z(e=>(console.log("\uD83D\uDD04 Zwiększam licznik odświeżeń:",e,"->",e+1),e+1))},50)}catch(e){console.error("❌ Błąd podczas odświeżania listy mecz\xf3w:",e)}finally{setTimeout(()=>{window._isRefreshingMatches=!1},500)}},[ep,n]);let eH=(0,i.useRef)(!1);i.useEffect(()=>{if(eH.current)return;eH.current=!0,console.log("\uD83D\uDD04 Inicjalizacja aplikacji - odświeżanie listy mecz\xf3w");let e=setTimeout(async()=>{try{await ep(n)}catch(e){console.error("❌ Błąd podczas inicjalizacji listy mecz\xf3w:",e)}},300);return()=>{clearTimeout(e)}},[ep,n]),i.useEffect(()=>{let e=!0,a=()=>{if(!e)return;let a=window.location.hash;if(console.log("Zmiana hash URL:",a),a.startsWith("#refresh=")){let o=a.replace("#refresh=","");console.log("Wykryto żądanie odświeżenia dla zespołu:",o),window.location.hash="",o&&e&&(o!==n&&t(o),setTimeout(async()=>{if(e){if(window._isRefreshingMatches){console.log("\uD83D\uDEAB Pominięto odświeżanie - już trwa inna operacja");return}window._isRefreshingMatches=!0;try{let a=await ep(o);e&&a?setTimeout(()=>{e&&Z(e=>e+1),window._isRefreshingMatches=!1},100):window._isRefreshingMatches=!1}catch(e){console.error("❌ Błąd podczas pobierania mecz\xf3w z URL hash:",e),window._isRefreshingMatches=!1}}},500))}};return a(),window.addEventListener("hashchange",a),()=>{e=!1,window.removeEventListener("hashchange",a)}},[ep,n]),(0,i.useEffect)(()=>{let e=!0,a=0,o=o=>{var i,s;if(!e)return;let r=null===(i=o.detail)||void 0===i?void 0:i.teamId,c=(null===(s=o.detail)||void 0===s?void 0:s.timestamp)||0;if(c<=a||window._isRefreshingMatches){console.log("\uD83D\uDEAB Ignoruję zdarzenie matchesListRefresh o czasie ".concat(c));return}a=c,console.log("\uD83D\uDD14 Złapano zdarzenie matchesListRefresh o czasie ".concat(c," dla zespołu:"),r),r&&r!==n?(console.log("\uD83D\uDD04 Zmieniam wybrany zesp\xf3ł na:",r),t(r)):e&&(console.log("\uD83D\uDD04 Odświeżam listę mecz\xf3w bez zmiany zespołu"),window._isRefreshingMatches=!0,setTimeout(()=>{e&&Z(e=>e+1),window._isRefreshingMatches=!1},100))};return console.log("\uD83C\uDFA7 Dodaję nasłuchiwanie na zdarzenie matchesListRefresh"),document.addEventListener("matchesListRefresh",o),()=>{e=!1,console.log("\uD83D\uDED1 Usuwam nasłuchiwanie na zdarzenie matchesListRefresh"),document.removeEventListener("matchesListRefresh",o)}},[n]);let eW=e=>{let a=e.teams||[];if($){let e=X.find(e=>e.id===$);if(e&&!e.teams&&"team"in e){let n=e.team;n&&!a.includes(n)&&(a=[...a,n])}}en({...e,teams:a})},eL=async e=>{await ea(e)&&ez===e&&(ex(null),eO())},eK=async()=>{if(console.log("onSaveAction wywołana z wartościami stref:",{startZone:y,endZone:f}),!ei){console.error("Brak informacji o meczu - nie można zapisać akcji"),ec(!0);return}if(!ez){console.error("Brak wybranego zawodnika - nie można zapisać akcji"),alert("Wybierz zawodnika rozpoczynającego akcję!");return}if("pass"===ek&&!eg){console.error("Brak wybranego odbiorcy dla podania - nie można zapisać akcji"),alert("Wybierz zawodnika kończącego podanie!");return}let e=y,a=f;if(null==e){let a=localStorage.getItem("tempStartZone");a&&console.log("Pobrano startZone z localStorage:",e=Number(a))}if(null==a){let e=localStorage.getItem("tempEndZone");e&&console.log("Pobrano endZone z localStorage:",a=Number(e))}if(console.log("Sprawdzanie stref przed zapisem:",{startZone:e,endZone:a,startZoneType:typeof e,endZoneType:typeof a,startZoneValue:0===e?"zero":e,endZoneValue:0===a?"zero":a,localStorage:{tempStartZone:localStorage.getItem("tempStartZone"),tempEndZone:localStorage.getItem("tempEndZone")}}),null==e){console.error("Brak strefy początkowej - nie można zapisać akcji"),alert("Wybierz strefę początkową akcji!");return}if(null==a){console.error("Brak strefy końcowej - nie można zapisać akcji"),alert("Wybierz strefę końcową akcji!");return}try{let n=Math.floor(e/12),t=e%12,o=(0,N.pU)(n,t),i=Math.floor(a/12),s=a%12,r=(0,N.pU)(i,s),c=e===a;c&&eP("dribble"),console.log("Stan przed zapisem akcji:",{selectedPlayerId:ez,selectedReceiverId:eg,actionType:c?"dribble":"pass",startZone:e,endZone:a,startXT:o,endXT:r,currentPoints:ej});try{console.log("Wywołuję handleSaveAction z parametrami:",{matchInfo:{matchId:ei.matchId,team:ei.team},startZone:e,endZone:a,startXT:o,endXT:r,currentPoints:ej,isSecondHalf:C});let n=await eZ(ei,e,a,o,r,ej,C);console.log("Wynik handleSaveAction:",n),n?(console.log("Akcja zapisana pomyślnie - resetuję stany stref"),localStorage.removeItem("tempStartZone"),localStorage.removeItem("tempEndZone"),j(null),w(null),m(!1)):console.error("Zapis akcji nie powi\xf3dł się - zachowuję wybrane strefy")}catch(e){console.error("Błąd podczas zapisywania akcji:",e),alert("Wystąpił błąd podczas zapisywania akcji: "+(e instanceof Error?e.message:String(e)))}}catch(e){console.error("Błąd podczas przygotowywania danych stref:",e),alert("Wystąpił błąd podczas przygotowywania danych: "+(e instanceof Error?e.message:String(e)))}},eJ=async e=>{console.log("\uD83D\uDCBE Zapisywanie nowego meczu:",e);try{let a=await el(e);return console.log("✅ Nowy mecz zapisany:",a),a}catch(e){return console.error("❌ Błąd przy zapisywaniu nowego meczu:",e),alert("Wystąpił błąd przy zapisywaniu meczu. Spr\xf3buj ponownie."),null}},eV=async e=>{console.log("\uD83D\uDCBE Zapisywanie edytowanego meczu:",e);try{let a=await el(e);return console.log("✅ Edytowany mecz zapisany:",a),a}catch(e){return console.error("❌ Błąd przy zapisywaniu edytowanego meczu:",e),alert("Wystąpił błąd przy zapisywaniu meczu. Spr\xf3buj ponownie."),null}},eq=i.useCallback(e=>{var a;let n="function"==typeof e?e(C):e;console.log("page.tsx - zmiana połowy na:",n?"P2":"P1","obecna wartość:",C),T(n),"function"==typeof ew.setIsSecondHalf&&ew.setIsSecondHalf(n),localStorage.setItem("currentHalf",n?"P2":"P1"),(null===(a=Y.current)||void 0===a?void 0:a.setIsSecondHalf)&&Y.current.setIsSecondHalf(n)},[C,ew]),eY=async e=>{console.log("\uD83D\uDDD1️ Usuwanie meczu o ID:",e);try{await eu(e),console.log("✅ Mecz usunięty pomyślnie")}catch(e){console.error("❌ Błąd podczas usuwania meczu:",e),alert("Wystąpił błąd podczas usuwania meczu. Spr\xf3buj ponownie.")}};return(0,i.useEffect)(()=>{let e=localStorage.getItem("tempStartZone"),a=localStorage.getItem("tempEndZone");console.log("Sprawdzenie zapisanych stref w localStorage:",{savedStartZone:e,savedEndZone:a}),e&&null===y&&(console.log("Wczytuję startZone z localStorage:",e),w(Number(e))),a&&null===f&&(console.log("Wczytuję endZone z localStorage:",a),j(Number(a)),e&&!u&&(console.log("Obie strefy wczytane z localStorage, otwieram ActionModal"),setTimeout(()=>m(!0),100)))},[]),(0,i.useEffect)(()=>{(async()=>{try{await (0,G.Po)()?(console.log("Kolekcja teams już istnieje w Firebase"),await (0,E.jS)()):(console.log("Kolekcja teams nie istnieje, rozpoczynam inicjalizację..."),await (0,G.TA)()&&(console.log("Pomyślnie utworzono kolekcję teams w Firebase"),await (0,E.jS)()))}catch(e){console.error("Błąd podczas sprawdzania/inicjalizacji kolekcji teams:",e)}})()},[]),(0,o.jsxs)("div",{className:B().container,children:[(0,o.jsx)(l,{}),(0,o.jsx)(V,{matchInfo:ei,onChangeMatch:()=>{console.log("Otwieranie modalu dla edycji meczu"),ec(!0)},allMatches:es,onSelectMatch:ed,onDeleteMatch:eY,selectedTeam:n,onChangeTeam:t,onManagePlayerMinutes:e=>{d(e),r(!0)},onAddNewMatch:()=>{console.log("Otwieranie modalu dla nowego meczu"),P(!0)},refreshCounter:A,isOfflineMode:ey}),(0,o.jsxs)("main",{className:B().content,children:[(0,o.jsx)(p,{players:eG,selectedPlayerId:ez,onPlayerSelect:ex,onAddPlayer:()=>ee(!0),onEditPlayer:et,onDeletePlayer:eL}),(0,o.jsx)(h,{activeTab:e,onTabChange:a}),(0,o.jsx)(W,{selectedZone:R,handleZoneSelect:(e,a)=>{if(null==e){console.error("handleZoneSelection: Otrzymano pustą strefę!");return}if(console.log("handleZoneSelection wywołane z:",{zoneId:e,xT:a,isNumber:"number"==typeof e,startZone:y,endZone:f}),null===y){console.log("Ustawiam startZone:",e),w(e),localStorage.setItem("tempStartZone",String(e)),setTimeout(()=>{console.log("Sprawdzenie po ustawieniu startZone:",{startZone:y})},50);return}if(null===f){console.log("Ustawiam endZone:",e),j(e),localStorage.setItem("tempEndZone",String(e)),setTimeout(()=>{console.log("Sprawdzenie po ustawieniu endZone:",{endZone:f}),setTimeout(()=>{console.log("Otwieram ActionModal z wartościami stref:",{startZone:y,endZone:f}),m(!0)},50)},50);return}console.log("Resetuję strefy i ustawiam nową startZone:",e),j(null),localStorage.removeItem("tempEndZone"),setTimeout(()=>{w(e),localStorage.setItem("tempStartZone",String(e)),console.log("Strefy po resecie:",{startZone:e,endZone:null})},50)},players:eG,selectedPlayerId:ez,setSelectedPlayerId:ex,selectedReceiverId:eg,setSelectedReceiverId:eD,actionMinute:eb,setActionMinute:eN,actionType:ek,setActionType:eP,currentPoints:ej,setCurrentPoints:eE,isP3Active:ev,setIsP3Active:eB,isShot:eI,setIsShot:eC,isGoal:eS,setIsGoal:eT,isPenaltyAreaEntry:e_,setIsPenaltyAreaEntry:eF,isSecondHalf:C,setIsSecondHalf:eq,handleSaveAction:eK,resetActionState:()=>{eO(),console.log("Wykonano resetowanie stanu akcji przy zachowaniu stref i zawodnik\xf3w")},startZone:y,endZone:f,isActionModalOpen:u,setIsActionModalOpen:m}),(0,o.jsx)(L,{actions:eh,players:eG,onDeleteAction:eM}),(0,o.jsx)(K,{isOpen:Q,onClose:eo,onSave:eW,editingPlayer:$?X.find(e=>e.id===$):void 0,currentTeam:n,allTeams:Object.values(E.T3)}),(0,o.jsx)(J,{isOpen:b,onClose:()=>{console.log("Zamykanie modalu dla nowego meczu"),P(!1),console.log("Modal nowego meczu zamknięty - lista mecz\xf3w zostanie odświeżona automatycznie")},onSave:eJ,currentInfo:null}),(0,o.jsx)(J,{isOpen:er,onClose:()=>{console.log("Zamykanie modalu dla edycji meczu"),ec(!1),console.log("Modal edycji meczu zamknięty - lista mecz\xf3w zostanie odświeżona automatycznie")},onSave:eV,currentInfo:ei}),c&&(0,o.jsx)(q,{isOpen:s,onClose:()=>{r(!1),d(null)},onSave:e=>{c&&em(c,e),r(!1),d(null)},match:c,players:X.filter(e=>e.teams&&e.teams.includes(c.team))}),(0,o.jsxs)("div",{className:B().buttonsContainer,children:[(0,o.jsx)(M,{players:X,actions:eh,matchInfo:ei}),(0,o.jsx)(U,{onImportSuccess:e=>{let n=e.players.filter(e=>!X.some(a=>a.id===e.id));n.length>0&&n.forEach(e=>{let{id:a,...n}=e;eW(n)});let t=e.actions.filter(e=>!eh.some(a=>a.id===e.id));t.length>0&&console.log("Dodano ".concat(t.length," nowych akcji")),e.matchInfo&&!es.some(a=>a.matchId===e.matchInfo.matchId)&&(a("packing"),d(e.matchInfo),ec(!0)),alert("Import zakończony sukcesem! Zaimportowano ".concat(n.length," graczy i ").concat(t.length," akcji."))},onImportError:e=>{alert("Błąd importu: ".concat(e))}}),(0,o.jsx)("button",{onClick:()=>{window.confirm("Czy na pewno chcesz się wylogować?")&&eU()},className:B().logoutButton,title:"Wyloguj się z aplikacji",children:"Wyloguj"})]}),(0,o.jsx)(F,{})]})]})}},9289:(e,a,n)=>{"use strict";n.d(a,{Po:()=>c,TA:()=>s,sb:()=>r});var t=n(6104),o=n(5317),i=n(9671);let s=async()=>{try{console.log("Rozpoczynam inicjalizację kolekcji teams w Firebase...");let e=Object.values(i.T)[0].id,a=(0,o.H9)(t.db,"teams",e);if((await (0,o.x7)(a)).exists())return console.log("Dokument team o ID ".concat(e," już istnieje, pomijanie inicjalizacji.")),!1;console.log("Dokumenty teams nie istnieją, rozpoczynam tworzenie kolekcji...");let n=Object.values(i.T).map(async e=>{try{return console.log("Pr\xf3ba dodania zespołu: ".concat(e.name," (").concat(e.id,")")),await (0,o.BN)((0,o.H9)(t.db,"teams",e.id),{id:e.id,name:e.name,createdAt:new Date,isSystem:!0}),console.log("✅ Dodano zesp\xf3ł: ".concat(e.name," (").concat(e.id,")")),!0}catch(a){throw console.error("❌ Błąd dodawania zespołu ".concat(e.name,":"),a),a}});if(await Promise.all(n),await c())return console.log("✅ Pomyślnie zainicjalizowano kolekcję teams i zweryfikowano jej istnienie."),!0;return console.error("❌ Inicjalizacja zakończona, ale weryfikacja nie powiodła się. Kolekcja może być pusta."),!1}catch(e){return console.error("❌ Błąd podczas inicjalizacji kolekcji teams:",e),e instanceof Error&&console.error("Szczeg\xf3ły błędu:",{name:e.name,message:e.message,stack:e.stack}),!1}},r=async()=>{try{for(let e of(console.log("Wymuszam inicjalizację kolekcji teams..."),Object.values(i.T)))try{await (0,o.BN)((0,o.H9)(t.db,"teams",e.id),{id:e.id,name:e.name,createdAt:new Date,isSystem:!0,updatedAt:new Date},{merge:!0}),console.log("Zaktualizowano/dodano zesp\xf3ł: ".concat(e.name," (").concat(e.id,")"))}catch(a){console.error("Błąd przy wymuszonym dodawaniu zespołu ".concat(e.name,":"),a)}return await c()}catch(e){return console.error("Błąd podczas wymuszonej inicjalizacji kolekcji teams:",e),!1}},c=async()=>{try{console.log("Sprawdzanie kolekcji teams...");let e=Object.values(i.T).map(e=>e.id),a=0;for(let n of e){let e=(0,o.H9)(t.db,"teams",n);(await (0,o.x7)(e)).exists()?(console.log("✅ Zesp\xf3ł ".concat(n," istnieje w Firebase")),a++):console.log("❌ Zesp\xf3ł ".concat(n," NIE istnieje w Firebase"))}let n=a===e.length;return console.log("Znaleziono ".concat(a,"/").concat(e.length," zespoł\xf3w w Firebase. Wynik sprawdzenia: ").concat(n?"SUKCES":"NIEPOWODZENIE")),n}catch(e){return console.error("Błąd podczas sprawdzania kolekcji teams:",e),e instanceof Error&&console.error("Szczeg\xf3ły błędu:",{name:e.name,message:e.message,stack:e.stack}),!1}}},9671:(e,a,n)=>{"use strict";n.d(a,{T:()=>t});let t=n(76).T3},9729:(e,a,n)=>{"use strict";n.d(a,{pU:()=>o});let t={a1:{name:["A",1],value:.00638303},a2:{name:["A",2],value:.00779616},a3:{name:["A",3],value:.00844854},a4:{name:["A",4],value:.00977659},a5:{name:["A",5],value:.01126267},a6:{name:["A",6],value:.01248344},a7:{name:["A",7],value:.01473596},a8:{name:["A",8],value:.0174506},a9:{name:["A",9],value:.02122129},a10:{name:["A",10],value:.02756312},a11:{name:["A",11],value:.03485072},a12:{name:["A",12],value:.0379259},b1:{name:["B",1],value:.00750072},b2:{name:["B",2],value:.00878589},b3:{name:["B",3],value:.00942382},b4:{name:["B",4],value:.0105949},b5:{name:["B",5],value:.01214719},b6:{name:["B",6],value:.0138454},b7:{name:["B",7],value:.01611813},b8:{name:["B",8],value:.01870347},b9:{name:["B",9],value:.02401521},b10:{name:["B",10],value:.02953272},b11:{name:["B",11],value:.04066992},b12:{name:["B",12],value:.04647721},c1:{name:["C",1],value:.0088799},c2:{name:["C",2],value:.00977745},c3:{name:["C",3],value:.01001304},c4:{name:["C",4],value:.01110462},c5:{name:["C",5],value:.01269174},c6:{name:["C",6],value:.01429128},c7:{name:["C",7],value:.01685596},c8:{name:["C",8],value:.01935132},c9:{name:["C",9],value:.0241224},c10:{name:["C",10],value:.02855202},c11:{name:["C",11],value:.05491138},c12:{name:["C",12],value:.06442595},d1:{name:["D",1],value:.00941056},d2:{name:["D",2],value:.01082722},d3:{name:["D",3],value:.01016549},d4:{name:["D",4],value:.01132376},d5:{name:["D",5],value:.01262646},d6:{name:["D",6],value:.01484598},d7:{name:["D",7],value:.01689528},d8:{name:["D",8],value:.0199707},d9:{name:["D",9],value:.02385149},d10:{name:["D",10],value:.03511326},d11:{name:["D",11],value:.10805102},d12:{name:["D",12],value:.25745362},e1:{name:["E",1],value:.00941056},e2:{name:["E",2],value:.01082722},e3:{name:["E",3],value:.01016549},e4:{name:["E",4],value:.01132376},e5:{name:["E",5],value:.01262646},e6:{name:["E",6],value:.01484598},e7:{name:["E",7],value:.01689528},e8:{name:["E",8],value:.0199707},e9:{name:["E",9],value:.02385149},e10:{name:["E",10],value:.03511326},e11:{name:["E",11],value:.10805102},e12:{name:["E",12],value:.25745362},f1:{name:["F",1],value:.0088799},f2:{name:["F",2],value:.00977745},f3:{name:["F",3],value:.01001304},f4:{name:["F",4],value:.01110462},f5:{name:["F",5],value:.01269174},f6:{name:["F",6],value:.01429128},f7:{name:["F",7],value:.01685596},f8:{name:["F",8],value:.01935132},f9:{name:["F",9],value:.0241224},f10:{name:["F",10],value:.02855202},f11:{name:["F",11],value:.05491138},f12:{name:["F",12],value:.06442595},g1:{name:["G",1],value:.00750072},g2:{name:["G",2],value:.00878589},g3:{name:["G",3],value:.00942382},g4:{name:["G",4],value:.0105949},g5:{name:["G",5],value:.01214719},g6:{name:["G",6],value:.0138454},g7:{name:["G",7],value:.01611813},g8:{name:["G",8],value:.01870347},g9:{name:["G",9],value:.02401521},g10:{name:["G",10],value:.02953272},g11:{name:["G",11],value:.04066992},g12:{name:["G",12],value:.04647721},h1:{name:["H",1],value:.00638303},h2:{name:["H",2],value:.00779616},h3:{name:["H",3],value:.00844854},h4:{name:["H",4],value:.00977659},h5:{name:["H",5],value:.01126267},h6:{name:["H",6],value:.01248344},h7:{name:["H",7],value:.01473596},h8:{name:["H",8],value:.0174506},h9:{name:["H",9],value:.02122129},h10:{name:["H",10],value:.02756312},h11:{name:["H",11],value:.03485072},h12:{name:["H",12],value:.0379259}},o=(e,a)=>{if(e>=0&&e<8&&a>=0&&a<12){var n;let o=["a","b","c","d","e","f","g","h"][e];return(null===(n=t["".concat(o).concat(a+1)])||void 0===n?void 0:n.value)||0}return 0}}},e=>{var a=a=>e(e.s=a);e.O(0,[389,992,158,288,884,441,684,358],()=>a(5273)),_N_E=e.O()}]);